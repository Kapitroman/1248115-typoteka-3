extends layout.pug

block variables
  -
    const mainPage = true;
    const MAX_LONG_STRING = 100;
    const cutLongString = (string, maxlength) => string.length > maxlength ? `${string.slice(0, maxlength - 1)}‚Ä¶` : string;
    const getFormatStringDate = (dateString) => {
      const date = new Date(dateString);
      const piecesDate = [
        `${date.getDate()}`.padStart(2, `0`),
        `${date.getMonth() + 1}`.padStart(2, `0`),
        `${date.getHours()}`.padStart(2, `0`),
        `${date.getMinutes()}`.padStart(2, `0`),
      ];

      return `${piecesDate[0]}.${piecesDate[1]}.${date.getFullYear()}, ${piecesDate[2]}:${piecesDate[3]}`;
    };

block content

  main.main-page
    h1.visually-hidden –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–∏—á–Ω–æ–≥–æ –±–ª–æ–≥–∞ –¢–∏–ø–æ—Ç–µ–∫–∞
    p
      | –≠—Ç–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –±–ª–æ–≥–∞ –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å, —á—Ç–æ–±—ã –æ–ø–∏—Å–∞—Ç—å —Å–µ–±—è üëè

    if articles.length
      section.main-page__theme-list
        h2.visually-hidden –°–ø–∏—Å–æ–∫ —Ç–µ–º
        ul.themes
          each category of categories
            if category.count > 0
              li.themes__item
                a.themes__item-link(href=`/articles/category/${category.id}`)
                  | #{category.name}
                  sup #{category.count}

      .main-page__section-flex
        section.main-page__hot.hot
          h2.hot__name
            | –°–∞–º–æ–µ –æ–±—Å—É–∂–¥–∞–µ–º–æ–µ
            span.hot__icon.hot__icon--fire
          if commentedArticles.length
            ul.hot__list
              each item of commentedArticles
                li.hot__list-item
                  a.hot__list-link(href=`/articles/${item.id}`) #{cutLongString(item.announce, MAX_LONG_STRING)}
                    sup.hot__link-sup #{item.commentsCount}
          else
            p.hot__empty –ó–¥–µ—Å—å –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç...

        section.main-page__last.last
          h2.last__name
            | –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
            span.last__icon.last__icon--cloud
          if comments.length
            ul.last__list
              each item of comments
                li.last__list-item
                  img.last__list-image(src=`/img/${item.users.avatar}` alt='–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è' width='20' height='20')
                  b.last__list-name #{item.users.firstName} #{item.users.lastName}
                  a.last__list-link(href=`/articles/${item.articleId}`) #{cutLongString(item.text, MAX_LONG_STRING)}
          else
            p.hot__empty –ó–¥–µ—Å—å –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç...

      section.main-page__list.preview
        h2.visually-hidden –°–ø–∏—Å–æ–∫ –ø—Ä–µ–≤—å—é —Å—Ç–∞—Ç–µ–π
        ul.preview__list
          each item in articles
            li.preview__item
              ul.preview__breadcrumbs(style='flex-wrap: wrap;')
                each category in item.categories
                  li.preview__breadcrumbs-item
                    a.preview__breadcrumbs-link(href=`/articles/category/${category.id}`) #{category.name}
              if (item.picture)
                .preview__background
                  img.preview__background-image(src=`/img/${item.picture}` alt=`${item.title}` width='460' height='240')
              time.preview__time(datetime=`${item.createdAt}`) #{getFormatStringDate(item.createdAt)}
              h3.preview__name
                a.preview__name-link(href=`/articles/${item.id}`) #{item.title}
              p.preview__text #{item.announce}
              a.preview__comment(href=`/articles/${item.id}`)
                | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
                span.preview__cloud
                  b.preview__comment-count #{item.comments.length}
      +pagination(page, totalPages, 2, `?`)
    else
      .main-page__empty-wrapper
          p.main-page__empty-text –ó–¥–µ—Å—å –ø–æ–∫–∞ –ø—É—Å—Ç–æ!
